---
title: ID ベースのドメイン
description: ID ベースのドメイン
copied-description: true
source-git-commit: 02ebc3548a254b2a6554f1ab34afbb3ea5f09bb8
workflow-type: tm+mt
source-wordcount: '476'
ht-degree: 0%

---

# ID ベースのドメイン {#identity-based-domains}

この使用例では、認証済みの各ユーザーに独自のドメインがあり、一定数のデバイスがドメインに参加できます。 参照実装でこのタイプのドメインを使用するには、ドメイン登録を指定するポリシーを作成する必要があります。 ドメインサーバー URL のサーバーのホストとポートを指定し、ユーザー名/パスワード認証が必要であることを指定します。

参照実装は、ドメイン登録に次のロジックを実装します。

1. このユーザーに割り当てるドメイン名を決定します。 ドメイン名は*になります。 `namequalifier:username`*認証トークンから抽出されました。 認証トークンがない場合は、エラー DOM_AUTHENTICATION_REQUIRED (503) を返します。
1. ドメイン名を `DomainServerInfo` 表。 エントリが見つからない場合は、テーブルにエントリを挿入します（デフォルト値は認証が必要で、最大ドメインメンバーシップ= 5）。
1. デバイスが既にドメインに登録されているかどうかを確認します。

   1. ドメイン名 ( `UserDomainMembership` 表。 見つかった各マシン ID について、リクエスト内のマシン ID と比較します。 これが新しいマシンの場合、 `UserDomainMembership` 表。 次に、 `UserDomainRefCount` 表。 このマシン GUID にエントリが存在しない場合は、レコードを追加します。

   1. 新しいデバイスで、 Max Membership に既に到達している場合は、エラー DOM_LIMIT_REACHED (502) を返します。

1. DomainKeys テーブルで、このドメインのすべてのドメインキーを参照します。

   1. 次の場合 `DomainServerInfo` キーをロールオーバーし、新しいキーペアを生成して、 `DomainKeys` （キーのバージョンが最も高い既存のキーより 1 つ高い）テーブルに追加し、 `DomainServerInfo`.

   1. 各ドメインキーに対して、ドメインの資格情報を生成します。

参照実装により、ドメインの登録解除に次のロジックが実装されます。

1. このユーザーに割り当てるドメイン名を決定します。 ドメイン名は次のようになります *namequalifier:username* 認証トークンから抽出されました。 認証トークンがない場合は、エラー DOM_AUTHENTICATION_REQUIRED (503) を返します。
1. で要求されたドメイン名を参照します。 `DomainServerInfo` 表。
1. ドメイン名を `UserDomainMembership` 表。 見つかった各マシン ID について、リクエスト内のマシン ID と比較します。 をクリックします。 `UserDomainRefCount` 表。 一致するエントリが見つからない場合は、エラー DEREG_DENIED (401) を返します。

1. これがプレビューリクエストでない場合は、 `UserDomainRefCount` 表。 マシンに対するエントリがこれ以上ない場合は、次の場所からエントリを削除します： `UserDomainMembership` で「キーのロールオーバーが必要」フラグを `DomainServerInfo`.

この使用例では、各ユーザーが少数のマシンを登録できるので、完全なマシン ID と `matches()` 機械を正確に計数する方法。 ただし、ユーザーがこのマシンに複数回登録できるので ( 異なるブラウザーの複数のAIRアプリケーションまたは Player を使用 )、登録解除を正確にカウントできるように、サーバーで参照カウントを維持する必要もあります。 登録解除は、コンピューター上のすべてのドメイントークンが放棄されるまで、完了したと見なすことはできません。
