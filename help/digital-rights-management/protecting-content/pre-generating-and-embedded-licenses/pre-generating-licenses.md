---
description: Adobe PrimetimeDRM Professionalを使用する場合は、ライセンスを事前に生成し、コンテンツにライセンスを埋め込むことができます。 この機能は拡張ライセンスチェーンと組み合わせることができます。拡張ライセンスチェーンと組み合わせて使用すると、リーフライセンスが事前に生成され、コンテンツに埋め込まれ、クライアントはRootライセンス（マシンまたはドメインにバインド）をライセンスサーバーから要求できます。 また、クライアントアプリケーションは、デバイスがサーバに事前登録され、サーバがそのデバイスに連結されたライセンスを事前生成し、クライアントが単純なHTTPウェブサーバからライセンスを取得するワークフローを実装できます。
title: 事前生成ライセンス
translation-type: tm+mt
source-git-commit: 89bdda1d4bd5c126f19ba75a819942df901183d1
workflow-type: tm+mt
source-wordcount: '611'
ht-degree: 0%

---


# 事前生成ライセンス{#pre-generating-licenses}

Adobe PrimetimeDRM Professionalを使用する場合は、ライセンスを事前に生成し、コンテンツにライセンスを埋め込むことができます。 この機能は拡張ライセンスチェーンと組み合わせることができます。拡張ライセンスチェーンと組み合わせて使用すると、リーフライセンスが事前に生成され、コンテンツに埋め込まれ、クライアントはRootライセンス（マシンまたはドメインにバインド）をライセンスサーバーから要求できます。 また、クライアントアプリケーションは、デバイスがサーバに事前登録され、サーバがそのデバイスに連結されたライセンスを事前生成し、クライアントが単純なHTTPウェブサーバからライセンスを取得するワークフローを実装できます。

ライセンスを事前生成する場合は、`com.adobe.flashaccess.sdk.license.pregen.LicenseFactory.getInstance()`を使用して`LicenseFactory`のインスタンスを取得する必要があります。 このファクトリによって生成されるライセンスに署名するには、License Server資格情報を指定する必要があります。 このクラスは、ライセンスチェーンなしでリーフライセンスを生成し、[拡張ライセンスチェーン](../../protecting-content/implementing-the-license-server/license-chaining/gen-enhanced-license-chaining.md)を使用してリーフライセンスとルートライセンスを生成できます。

リーフライセンスを生成する場合は、`initContentInfo()`を適用するコンテンツメタデータを指定する必要があります。 メタデータに複数のDRMポリシーが含まれる場合、またはメタデータに含まれていないDRMポリシーを使用する場合は、`setSelectedPolicy()`を使用してDRMポリシーを指定してライセンスを生成する必要があります。 DRMポリシーの更新リストを使用してDRMポリシーの更新を追跡する場合、`setPolicyUpdateList()`を使用してメタデータを初期化する前に、DRMポリシーの更新リストをライセンスファクトリに提供できます。

Rootライセンスを生成する場合は、上記の説明に従ってコンテンツのメタデータを指定する必要があります。 または、メタデータの代わりにDRMポリシー(`setSelectedPolicy()`)とライセンスサーバーURL(`setLicenseServerURL()`)を適用してRootライセンスを生成できます。

>[!NOTE]
>
>クライアントがライセンスを要求できるAdobe PrimetimeDRMライセンスサーバーがない場合でも、ライセンスサーバーURLが必要です。 この場合、License ServerのURLには、ライセンス発行者を識別するURLを指定する必要があります。

DRMポリシーで拡張ライセンスチェーンを使用する場合は、DRMポリシー(`setRootKeyRetrievalInfo()`)のルート暗号化キーを復号化するためのライセンスサーバーの秘密鍵証明書を指定する必要があります。

DRMポリシーにドメインバウンドライセンスが必要な場合は、`setDomainCAs()`を使用して、ライセンスサーバーがドメイントークンを受け入れるドメイン発行者を指定する必要があります。 ライセンス受信者を検証するには、1つ以上のドメインCA証明書を指定する必要があります。

iOSデバイスに対してDRMポリシーでリモートキーの配信が必要な場合は、チェーンリーフが生成されない限り、`setKeyServerCertificate()`を適用してキーサーバー証明書を指定する必要があります。

ライセンスを生成する場合は、`generateLicense()`を呼び出し、ライセンスの種類（リーフまたはルート）と1つ以上の受信者証明書を指定する必要があります。 受信者証明書は、DRMポリシーで指定された要件に応じて、コンピューター証明書またはドメイン証明書を表します。 連結リーフを生成する場合、受信者は必要ありません。 ライセンスが生成されたら、DRMポリシーで指定された使用規則を上書きできます。 最後に、`signLicense()`を呼び出してライセンスに署名し、`PreGeneratedLicense`のインスタンスを取得する必要があります。 ライセンスを保存できるようになりました（`getBytes()`を使用してシリアライズ済みのライセンスを取得したり、暗号化されたコンテンツに埋め込んだりできます）。

「[ライセンスの埋め込み](../../protecting-content/pre-generating-and-embedded-licenses/embedding-licenses.md)」を参照してください。

事前に生成されたライセンスのデモ方法に関するサンプルコードについては、リファレンス実装のコマンドラインツールの&quot;samples&quot;ディレクトリの`com.adobe.flashaccess.samples.licensegen.GenerateLicense`を参照してください。
