---
description: ビデオオンデマンド(VOD)の広告挿入プロセスは、広告解決、広告挿入、広告再生の各フェーズで構成されます。 広告トラッキングの場合、ブラウザーTVSDKは、各広告の再生進行状況をリモートトラッキングサーバーに通知する必要があります。 予期しない状況が発生した場合は、適切なアクションが必要です。
title: VOD用の広告挿入とフェイルオーバー
translation-type: tm+mt
source-git-commit: 89bdda1d4bd5c126f19ba75a819942df901183d1
workflow-type: tm+mt
source-wordcount: '671'
ht-degree: 0%

---


# VODの広告挿入とフェイルオーバー{#advertising-insertion-and-failover-for-vod}

ビデオオンデマンド(VOD)の広告挿入プロセスは、広告解決、広告挿入、広告再生の各フェーズで構成されます。 広告トラッキングの場合、ブラウザーTVSDKは、各広告の再生進行状況をリモートトラッキングサーバーに通知する必要があります。 予期しない状況が発生した場合は、適切なアクションが必要です。

## 広告解決フェーズ{#section_F562CD6D0EF04AA9A0A3C0176A4EC340}

ブラウザーTVSDKは、Adobe Primetimead decisioningなどの広告配信サービスと通信し、広告のビデオストリームに対応するプライマリプレイリストファイルを取得しようとします。 広告解決フェーズ中に、Browser TVSDKがリモート広告配信サーバーに対してHTTP呼び出しを行い、サーバーの応答を解析します。

ブラウザーTVSDKは、次のタイプの広告プロバイダーをサポートしています。

* メタデータ広告プロバイダー

   広告データはプレーンテキストのJSONファイルにエンコードされます。
* Adobe Primetime広告プロバイダー

   ブラウザーTVSDKは、一連のターゲティングパラメーターとアセットID番号を含むリクエストをAdobe Primetimead decisioningバックエンドサーバーに送信します。 Adobe Primetimead decisioningは、必要な広告情報を含むSMIL(synchronized multimedia integration language)ドキュメントを返します。

   このフェーズでは、次のいずれかのフェイルオーバー状況が発生する可能性があります。

   * 接続不足や、リソースが見つからないなどのサーバー側のエラーなどの理由で、データを取得できません。
   * データを取得しましたが、形式が無効です。

      これは、例えば、受信データの解析に失敗した場合に発生する可能性があります。
   ブラウザーTVSDKは、エラーに関する警告通知を発行し、処理を続行します。

## 広告挿入フェーズ{#section_88A0E4FA12394717A9D85689BD11D59F}

ブラウザーTVSDKは、メインコンテンツに対応するタイムラインに代替コンテンツ（広告）を挿入します。

広告解決フェーズが完了すると、ブラウザーTVSDKは、広告リソースを順序付けたリストを持ち、広告の時間にグループ化します。 各広告の時間は、ミリ秒（ミリ秒）で表される開始時間値を使用して、メインコンテンツのタイムライン上に配置されます。 広告の時間内の各広告には、同時にミリ秒単位で表される継続時間プロパティがあります。 広告の時間内の広告は、次から次へと連結されています。 その結果、広告の時間の長さは、構成する個々の広告の継続時間の合計に等しくなります。

このフェーズでは、広告挿入中にタイムラインで発生する可能性がある競合によって、フェイルオーバーが発生する可能性があります。 広告の時間の開始時間/時間の値を特定の組み合わせで組み合わせると、広告セグメントが重なる場合があります。 重複は、ある広告の時間の最後の部分が、次の広告の時間の最初の広告の先頭と交差する場合に発生します。 このような状況では、Browser TVSDKは、後の広告の時間を破棄し、すべての広告の時間が挿入または破棄されるまで、リスト上の次のアイテムを使用して広告挿入プロセスを続行します。

ブラウザーTVSDKは、エラーに関する警告通知を発行し、処理を続行します。

## 広告再生フェーズ{#section_7B0073BE9A744C74929263182C1243FC}

ブラウザーTVSDKが広告セグメントをダウンロードし、デバイスの画面にレンダリングします。

この時点で、Browser TVSDKは広告を解決し、タイムライン上に配置して、コンテンツを画面にレンダリングしようとします。

このフェーズでは、次のエラーのメインクラスが発生する可能性があります。

* ホストサーバーへの接続時のエラー
* マニフェストファイルのダウンロード時のエラー
* メディアセグメントのダウンロード時のエラー

3つのエラークラスすべてに対して、Browser TVSDKは、トリガーされたイベントを次のようなアプリケーションに転送します。

* フェールオーバーの発生時にトリガーされる通知イベント。
* フェールオーバーアルゴリズムが原因でプロファイルが変更された場合の通知イベント。
* すべてのフェイルオーバーオプションが考慮された場合にトリガーされ、追加のアクションを自動的に実行できない通知イベント。

   アプリケーションが適切な対応を行う必要があります。

エラーが発生したかどうかに関わらず、広告の時間の開始が発生した場合と完了した場合に、Browser TVSDKから通知されます。 ただし、セグメントをダウンロードできない場合は、タイムラインにギャップがある可能性があります。 すき間が十分に大きい場合、再生ヘッド位置の値とレポートされる広告の進行状況の値が不連続を示す可能性があります。
