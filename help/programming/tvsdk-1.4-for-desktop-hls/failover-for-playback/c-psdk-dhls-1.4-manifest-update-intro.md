---
description: TVSDKは、ライブストリーミング用のマスターm3u8マニフェスト内で変更された再生情報を検出し、ストリームの再生中に再生情報を更新できます。 TVSDKは、更新間で重複しないプロファイルビットレートなど、マスターマニフェストにプロファイルが出現したり、出現しなくなったりする際のビットレートプロファイルの動的セットをサポートしています。
title: ライブマスターマニフェストの更新
translation-type: tm+mt
source-git-commit: 89bdda1d4bd5c126f19ba75a819942df901183d1
workflow-type: tm+mt
source-wordcount: '740'
ht-degree: 0%

---


# ライブマスターマニフェストの更新{#live-master-manifest-update}

TVSDKは、ライブストリーミング用のマスターm3u8マニフェスト内で変更された再生情報を検出し、ストリームの再生中に再生情報を更新できます。 TVSDKは、更新間で重複しないプロファイルビットレートなど、マスターマニフェストにプロファイルが出現したり、出現しなくなったりする際のビットレートプロファイルの動的セットをサポートしています。

次の機能がサポートされています。

* プロファイル数（増減）
* プロファイルビットレート（重なり合う、重ならない）
* 同じ（または異なる）サーバー上にURLを持つプロファイル
* 任意のフェイルオーバー構造

次の条件をすべて満たす必要があります。

* ストリームがライブです。
* 時間とetagの両方が変更されます。
* すべてのレンディション情報は同じままです（URLは異なる場合があります）。
* DRMアクセス情報は同じままです。
* セグメントは、小さなエラー範囲で、同じPTSおよびフレーム境界の周りにパッケージ化されます。

## ライブマスターマニフェストの更新アーキテクチャ{#section_32254A0F684B4960ACC33BF6B1AEF6F1}

TVSDKが更新されたマスターマニフェストをどのように受け入れるかに関する情報と例を以下に示します。

デフォルトでは、この機能はオフになっています。 更新頻度を分単位で設定して、アプリケーションがこの機能をオンにした場合、更新間隔ごとに次の手順が実行されます。

1. TVSDKは、マスターマニフェストの最終変更時間とetagを調べて、ファイルが更新されているかどうかを判断します。

   時間とetagの両方が変更された場合、ファイルは変更済みと見なされます。
1. TVSDKは、新しいマニフェストを解析および分析し、更新の性質に基づいて適切なアクションを実行します。
1. 現在の再生ビットレートが変更されたマニフェストのビットレートと一致する場合、TVSDKは新しいプロファイルに切り替えます。

   新しいプロファイルは、異なるサーバーまたは同じサーバーの同じビットレートである場合があります。 この場合、トランジションはスムーズです。
1. 現在の再生ビットレートが新しいマニフェストに存在しない場合、TVSDKは、新しいマニフェストにも存在するビットレートを現在のプロファイル内で見つけようとします。

   * 一致が見つかった場合、プレイヤーは、最初に既存のマニフェスト内の一致ビットレートプロファイルに切り替え、更新されたマニフェスト内の一致ビットレートプロファイルに切り替えます。 これにより、トランジションがスムーズになります。
   * 以前のマニフェストと新しいマニフェストとの間にビットレートが共通でない場合、またはTVSDKが一致するビットレートに切り替えられない場合、TVSDKは、新しいマニフェストの最も低いビットレートプロファイルに直接切り替え、ABRを使用して、帯域幅に基づいて許可される任意のビットレートに切り替えます。 これは、再生に若干の問題を引き起こす可能性がありますが、影響は最小限に抑える必要があります。

1. 更新が成功すると、TVSDKは`MediaPlayerItemEvent.MASTER_UPDATED`イベントをディスパッチします。
1. 更新が成功しなかった場合、この更新前のセットアップで再生が続行されます。

### 例1 {#example_DB55F2B9D98741628C9B973E47A0B6A0}

以下のビットレートがライブ放送されています。

* 50万
* 90万
* 2,100,000

2100kのストリームに問題があるので、再起動する必要があります。 マスターマニフェストが更新され、500kと900kのみが含まれるようになりました。 その後すぐに、2100kでこのプログラムを見ているユーザーは、ビットレートが900kに切り替わります。 900kで視聴しているユーザーは、引き続き900kで視聴します。 その後、2100kのストリームが再開され、マスターマニフェストに再度追加されます。 しばらくしてから、900kで視聴し、帯域幅を持つユーザーは、2100kに切り替えられます。

### 例2 {#example_485E9A9F373D454CADE5395DEC734E5D}

以下のビットレートがライブ放送されています。

* 50万
* 90万
* 2,100,000

これらのビットレートはすべて再起動する必要があります。 これに対して設定されている2つの一時ストリーム（400kと1500k）があります。 ユーザーは400kに切り替えられます。これは、新しい設定で最も低いビットレートです。 十分な帯域幅がある場合、一部のユーザーは1500kに切り替えられます。 その後、3つのビットレートがバックアップされ、マスターマニフェストが更新されます。 ユーザーは、改訂された（元の）マニフェストで最も低い帯域幅である500kでの視聴に自動的に切り替わります。 しばらくしてから、ユーザーは、ネットワークで許容される最高の帯域幅（900kまたは1200k）に切り替えられます。

## ライブマスターマニフェストの更新{#section_34AC4A9751DB4B7C8561302C6A59A1C4}を使用

この機能をオンにして、関連イベントを確認できます。

1. ライブマスターマニフェストの更新を有効にするには、`NetworkConfiguration.masterUpdateInterval`プロパティを設定して更新頻度（分単位）を設定します。
1. オプションで、`MediaPlayerItemEvent.MASTER_UPDATED`イベントをリッスンして、成功したマニフェストの更新を追跡します。

