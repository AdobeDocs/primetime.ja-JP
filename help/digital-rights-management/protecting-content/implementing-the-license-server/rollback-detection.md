---
seo-title: ロールバックの検出
title: ロールバックの検出
uuid: ec124bac-a1d7-45be-bf09-a99d5eec5042
translation-type: tm+mt
source-git-commit: 29bc8323460d9be0fce66cbea7c6fce46df20d61

---


# ロールバックの検出 {#rollback-detection}

ロールバック検出の場合、一部の使用ルールでは、権限を適用するためにクライアントが状態情報を維持する必要があります。 例えば、再生ウィンドウの使用ルールを強制するために、クライアントは、ユーザーがコンテンツの最初の表示を開始した日時を保存します。 このイベントは、再生ウィンドウの開始をトリガーします。 再生ウィンドウを安全に強制するには、クライアントに保存されている再生ウィンドウの開始時間を削除するために、ユーザーがクライアントの状態をバックアップおよび復元しないようにする必要があります。 サーバは、クライアントのロールバックカウンタの値を追跡することで、これを行います。

要求ごとに、サーバーは、を呼び出してオブジェクトを取得し、次にを呼び出して、ク `RequestMessageBase.getClientState()` ライアント状態カ `ClientState` ウンタ `ClientState.getCounter()` ーの現在の値を取得することで、カウンターの値を取得します。 サーバは、各クライアントにこの値を格納し(ロールバックカウンタ値に関連付けられ `MachineId.getUniqueId()` たクライアントを識別するために使用)、次にを呼び出してカ `ClientState.incrementCounter()` ウンタ値を1ずつ増やす必要があります。 カウンタ値がサーバーで最後に表示された値より小さいことをサーバーが検出した場合は、クライアントの状態がロールバックされている可能性があります。

クライアント状態の改ざん検出について詳しくは、 `ClientState` APIリファレンスドキュメントを参照してください。
