---
description: ライブビデオストリームのブラックアウトを処理し、ブラックアウト中に代替コンテンツを提供できます。
seo-description: ライブビデオストリームのブラックアウトを処理し、ブラックアウト中に代替コンテンツを提供できます。
seo-title: ライブストリームのブラックアウトの処理
title: ライブストリームのブラックアウトの処理
uuid: df933087-c8a8-49eb-a016-6dfd971c219c
translation-type: tm+mt
source-git-commit: 040655d8ba5f91c98ed0584c08db226ffe1e0f4e
workflow-type: tm+mt
source-wordcount: '539'
ht-degree: 0%

---


# ライブストリームのブラックアウトの処理{#handle-blackouts-in-live-streams}

ライブビデオストリームのブラックアウトを処理し、ブラックアウト中に代替コンテンツを提供できます。

ライブストリームでブラックアウトが発生した場合、プレイヤーはイベントハンドラーを使用してブラックアウトを検出し、メインストリームを視聴する資格のないユーザーに代替コンテンツを提供します。 プレイヤーは、ブラックアウト期間の開始と終了を検出し、再生をメインストリームから代替ストリームに切り替え、ブラックアウト期間が終了したらメインストリームに切り替えます。

クライアントアプリケーションで、TVSDKのブラックアウトタグをサブスクライブします。 新しい&#x200B;*時間指定メタデータ*&#x200B;オブジェクトの通知を受けたら、時間指定メタデータオブジェクトのデータを解析して、オブジェクトがブラックアウトのエントリまたは終了を示しているかどうかを識別します。 識別されたブラックアウトに対して、関連するTVSDK要素を呼び出して、ブラックアウトの開始時に代替コンテンツに切り替え、ブラックアウトの終了時に再びメインコンテンツに戻ります。

>[!TIP]
>
>キーは、コンテンツが再生される前もマニフェストからダウンロードされます。

ブラックアウト期間が終了した後にユーザーがライブストリームに接続し、ブラックアウト期間にスクロールバックすると、コンテンツが再生されます。

>[!IMPORTANT]
>
>すべてのキー要求が失敗した場合、マニフェストの解析時にエラーが発生します。 一部のリクエストが失敗し、一部が成功した場合、TVSDKはコンテンツの再生を試みます。 TVSDKがコンテンツのセクションを再生しようとしたが、このコンテンツを復号化する有効なキーがない場合、エラーを返します。

ライブストリーム内のブラックアウトを処理するには：

1. ライブストリームマニフェストのブラックアウトタグをサブスクライブすることで、ブラックアウトタグを検出するようにアプリを設定します。

   TVSDKは、ブラックアウトタグをそれ自体で検出しません。マニフェストファイルの解析中にタグを検出した場合に通知を受け取るには、ブラックアウトタグをサブスクライブする必要があります。
1. プレイヤーがサブスクライブされているタグ用のイベントリスナーを作成します。

   プレイヤーがフォアグラウンド（メインコンテンツ）またはバックグラウンド（代替コンテンツ）のストリームマニフェストでサブスクライブしたタグ（ブラックアウトタグなど）が発生すると、TVSDKは`TimedMetadataEvent`をディスパッチし、`TimedMetadataEvent`の`TimedMetadataObject`を作成します。
1. フォアグラウンドストリームとバックグラウンドストリームの両方に対して時間指定メタデータイベントーのハンドラーを実装します。

   これらのハンドラーで、時間指定メタデータイベントオブジェクトから、ブラックアウト期間の開始および終了時間を取得します。
1. ブラックアウト用に`MediaPlayer`を準備します。

   `MediaPlayer`がPREPARED状態に入ったら、ブラックアウト範囲を計算して準備し、`MediaPlayer`オブジェクトに設定します。

1. 再生ヘッド位置の更新ごとに、`TimedMetadataObjects`のリストを確認します。

   ここで、プレイヤーがブラックアウト開始と終了を検出し、ブラックアウトの発生時にその時間を追跡します。

1. ブラックアウト期間の開始時と終了時にコンテンツを切り替える方法を作成します。

   ブラックアウト期間の開始が発生した場合は、メインコンテンツをバックグラウンドに切り替え、代替コンテンツがメインストリームになるように切り替えます。 引き続き、バックグラウンドで元のマニフェストの取得と解析を行い、「ブラックアウト終了」タグをチェックし続けます。これにより、ブラックアウトが終了したときにプレイヤーが元のストリームに再結合できます。

