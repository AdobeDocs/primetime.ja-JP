---
title: ロールバック検出
description: ロールバック検出
copied-description: true
source-git-commit: 02ebc3548a254b2a6554f1ab34afbb3ea5f09bb8
workflow-type: tm+mt
source-wordcount: '204'
ht-degree: 0%

---

# ロールバック検出{#rollback-detection}

ロールバック検出の場合、一部の使用ルールでは、権限を適用するためにクライアントが状態情報を維持する必要があります。 例えば、再生ウィンドウの使用ルールを強制するために、クライアントは、ユーザーが最初にコンテンツの表示を開始した日時を保存します。 このイベントは、トリガーウィンドウの開始を再生します。 再生ウィンドウを安全に実施するために、サーバーは、クライアントに保存されている再生ウィンドウの開始時間を削除するために、ユーザーがクライアント状態のバックアップおよび復元を行っていないことを確認する必要があります。 サーバーは、クライアントのロールバックカウンターの値を追跡することでこれを実行します。 リクエストごとに、サーバーはを呼び出すことでカウンターの値を取得します `RequestMessageBase.getClientState()` 手に入れる `ClientState` オブジェクト、次に `ClientState.getCounter()` クライアント状態カウンタの現在の値を取得する。 サーバーは、クライアントごとにこの値を保存する必要があります ( `MachineId.getUniqueId()` を呼び出して、ロールバックカウンタ値に関連付けられたクライアントを特定し、 `ClientState.incrementCounter()` を使用してカウンタ値を 1 ずつ増やします。 サーバがカウンタ値が、サーバが最後に閲覧した値より小さいことを検出した場合、クライアントの状態がロールバックされた可能性があります。 クライアント状態の改ざん検出の詳細については、 `ClientState` API リファレンスドキュメント。
