---
description: メディアを早送りまたは巻き戻しする場合、ユーザーはトリック再生モードになります。 トリック再生モードに入るには、 MediaPlayer の再生速度を 1 以外の値に設定する必要があります。
title: 早送りと巻き戻しの実装
source-git-commit: 02ebc3548a254b2a6554f1ab34afbb3ea5f09bb8
workflow-type: tm+mt
source-wordcount: '775'
ht-degree: 0%

---

# 早送りと巻き戻しの実装 {#implement-fast-forward-and-rewind}

メディアを早送りまたは巻き戻しする場合、ユーザーはトリック再生モードになります。 トリック再生モードに入るには、 MediaPlayer の再生速度を 1 以外の値に設定する必要があります。

速度を切り替えるには、1 つの値を設定する必要があります。

1. 通常再生モード (1x) から、 `rate` プロパティを `MediaPlayer` を使用して、値を設定できます。

   * The `MediaPlayerItem` クラスは、許可される再生レートを定義します。
   * 指定されたレートが許可されていない場合、 TVSDK は許可されている最も近いレートを選択します。

     トリック再生レートを 0（一時停止）または 1（通常再生）から 1 より大きいまたは —1 未満のレートに変更すると、タイムライン上のすべての広告が削除されます。 タイムライン全体に 1 つのピリオドしかなく、トリック再生アクションを容易にして、コンテンツをどの広告位置でも停止することなく、速やかに転送し、巻き戻すことができます。 このアクションは、 TVSDK のタイムラインの切り離しアクションによって、解決されたすべての adBreaks を削除することで有効になります。 トリック再生が 0 または 1 で再開されると、adBreaks は、まずタイムライン添付アクションによって復元されます。

     次の情報に留意してください。

   * トリック再生アクションがコンテンツを巻き戻す場合、レートが 1 に変更されると再生が再開されます。
   * トリック再生アクションがコンテンツを早送りする場合、最後にスキップされた adBreak は、再開位置で再生されます。

   この例では、プレーヤーの内部再生率を、要求された率に設定します。

   ```
   private function onPlaybackRateChange(event:IndexChangeEvent):void { 
       var newRateIndex:int = event.newIndex; 
       var newRate:Number = _playbackRates[newRateIndex]; 
   
       _player.rate = newRate; 
   } 
   ```

1. オプションで、レート変更イベントをリッスンできます。このイベントを使用して、レート変更のリクエストを行った日時や、レート変更が実際に発生した日時を通知できます。

   TVSDK は、トリック再生に関連する以下のイベントをディスパッチします。

   * `mediacore.events.PlaybackRateEvent.RATE_SELECTED` 時に `rate` の値が別の値に変更された場合。

   * `mediacore.events.PlaybackRateEvent.RATE_PLAYING` 選択した速度で再生が再開されたとき。

   TVSDK は、プレーヤーがトリック再生モードから通常再生モードに戻ると、これらの両方のイベントをディスパッチします。

## レート変更 API 要素 {#rate-change-api}

TVSDK には、有効な率、現在の率、トリック再生がサポートされているかどうか、および早送りと巻き戻しに関連するその他の機能を決定するメソッド、プロパティ、イベントが含まれています。

再生率を変更するには、次の API 要素を使用します。

* `MediaPlayer.rate` setter および getter 関数のプロパティ
* `MediaPlayer.localTime property` ゲッター関数
* `mediacore.events.PlaybackRateEvent.RATE_SELECTED`
* `mediacore.events.PlaybackRateEvent.RATE_PLAYING`
* `MediaPlayerItem.IsTrickPlaySupported` getter 関数を持つプロパティ
* `AdBreakPlaybackEvent.AD_BREAK_SKIPPED`
* `MediaPlayerItem.availablePlaybackRates` getter 関数を持つプロパティ — 有効な率を指定します。

| レート値 | 再生時の効果 |
|---|---|
| 2.0, 4.0, 8.0, 16.0, 32.0, 64.0  , 128.0 | 指定した乗数が通常よりも速い早送りモードに切り替えます（たとえば、4 は通常より 4 倍も速い）。 |
| -2.0, -4.0, -8.0, -16.0, -32.0, -64.0  , -128.0 | 早戻しモードに切り替えます。 |
| 1.0 | 通常の再生モードに切り替えます ( `play` は、 rate プロパティを 1.0 に設定するのと同じです )。 |
| 0.0 | 一時停止（呼び出し） `pause` は、 rate プロパティを 0.0 に設定する場合と同じです )。 |

## トリック再生の制限事項と動作 {#limitations-behavior-trick-play}

トリック再生モードの制限事項を次に示します。

* マスター再生リストには、I-frame のみのセグメントを含める必要があります。 I-frame トラックのキーフレームのみが画面に表示されます。
* オーディオトラックとクローズドキャプションは無効です。
* 可変ビットレート (ABR) ロジックは無効です。 TVSDK は、提供されるレートが最も低いから 800 kbps の間の 1 つのビットレートを選択し、トリック再生セッション全体でそのレートを使用します。
* 再生と一時停止が有効になっています。
* シークは許可されていません。 シークするには、を呼び出します。 `pause` トリック再生モードを終了してからを呼び出す `seek`.

* トリック再生モードを終了して、許可されている再生速度（再生または一時停止）にすることができます。
* ストリームに広告を組み込む場合：

   * メインコンテンツの再生中にのみ、トリック再生に移動できます。 広告の時間中にトリック再生に切り替えようとすると、エラーがディスパッチされます。
   * トリック再生モードを開始した後、広告の時間は無視され、広告イベントは発生しません。
   * TVSDK がプレーヤーアプリケーションに公開するタイムラインは、広告の時間がスキップされた場合でも変更されません。
   * The `MediaPlayer.currentTime` プロパティは、スキップされた広告ブレークの時間で前方（早送り時）または後方（早戻し時）にジャンプします。 現在の時間に対するこのジャンプ動作により、トリック再生中にストリームの時間を変更しないでおくことができます。 プレーヤーアプリケーションでは、 `localTime` プロパティを使用して、メインコンテンツに対する時間のみを基準に追跡します。 広告のスキップ時にローカル時間に対して返された値に対して時間ジャンプは実行されません。

   * The `AdBreakPlaybackEvent.AD_BREAK_SKIPPED` イベントは、広告の時間がスキップされる直前にディスパッチされます。 プレーヤーでは、このイベントを使用して、スキップされた広告の時間に関連するカスタムロジックを実装できます。
   * 既存のトリック再生が、既存のシークと同じ広告再生ポリシーを呼び出します。

     したがって、シークと同様、動作は、アプリケーションの再生ポリシーがデフォルトと異なるかどうかによって異なります。 デフォルトでは、最後にスキップされた広告の時間は、トリック再生から離れた時点で再生されます。
