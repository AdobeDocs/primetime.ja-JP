---
description: ライブビデオストリームのブラックアウトを処理し、ブラックアウト中に代替コンテンツを提供できます。
seo-description: ライブビデオストリームのブラックアウトを処理し、ブラックアウト中に代替コンテンツを提供できます。
seo-title: ライブストリームのブラックアウトの処理
title: ライブストリームのブラックアウトの処理
uuid: df933087-c8a8-49eb-a016-6dfd971c219c
translation-type: tm+mt
source-git-commit: 040655d8ba5f91c98ed0584c08db226ffe1e0f4e

---


# ライブストリームのブラックアウトの処理{#handle-blackouts-in-live-streams}

ライブビデオストリームのブラックアウトを処理し、ブラックアウト中に代替コンテンツを提供できます。

ライブストリームでブラックアウトが発生した場合、プレーヤーは、イベントハンドラーを使用してブラックアウトを検出し、メインストリームを視聴する資格のないユーザーに代替コンテンツを提供します。 プレイヤーはブラックアウト期間の開始と終了を検出し、再生をメインストリームから代替ストリームに切り替え、ブラックアウト期間が終了するとメインストリームに切り替えます。

クライアントアプリで、TVSDKのブラックアウトタグをサブスクライブします。 新しい時間指定メタデー *タ* ・オブジェクトの通知を受けたら、時間指定メタデータ・オブジェクトのデータを解析して、オブジェクトがブラックアウトのエントリまたは終了を示しているかどうかを識別します。 識別されたブラックアウトの場合は、関連するTVSDK要素を呼び出して、ブラックアウトの開始時に代替コンテンツに切り替え、ブラックアウトが終了した時点で再びメインコンテンツに戻ります。

>[!TIP]
>
>キーは、コンテンツが再生される前にマニフェストからダウンロードされます。

ブラックアウト期間が終了した後にユーザーがライブストリームに接続し、ブラックアウト期間まで時間内にスクロールバックすると、コンテンツが再生されます。

>[!IMPORTANT]
>
>すべてのキー要求が失敗した場合、マニフェストの解析時にエラーが発生します。 一部のリクエストが失敗し、一部が成功した場合、TVSDKはコンテンツの再生を試みます。 TVSDKがコンテンツの一部を再生しようとしたが、このコンテンツを復号化する有効なキーがない場合は、エラーを返します。

ライブストリームのブラックアウトを処理するには：

1. ライブストリームマニフェスト内のブラックアウトタグをサブスクライブして、ブラックアウトタグを検出するようにアプリを設定します。

   TVSDKは、ブラックアウトタグを単独で検出しません。マニフェストファイルの解析中にタグが検出された場合に通知を受け取るには、ブラックアウトタグをサブスクライブする必要があります。
1. プレーヤーがサブスクライブするタグのイベントリスナーを作成します。

   プレイヤーがフォアグラウンド（メインコンテンツ）またはバックグラウンド（代替コンテンツ）のストリームマニフェストでサブスクライブしたタグ（ブラックアウトタグなど）が発生すると、TVSDKは、をディスパッチし、そのためのを `TimedMetadataEvent` 作成しま `TimedMetadataObject``TimedMetadataEvent`す。
1. フォアグラウンドストリームとバックグラウンドストリームの両方に対して、時間指定メタデータイベントのハンドラーを実装します。

   これらのハンドラーで、時間指定メタデータイベントオブジェクトから、ブラックアウト期間の開始時間と終了時間を取得します。
1. ブラックアウ `MediaPlayer` トの準備を。

   がPREPARED状態に `MediaPlayer` 入ったら、ブラックアウト範囲を計算して準備し、オブジェクトに設定し `MediaPlayer` ます。

1. 再生ヘッドの位置を更新するたびに、のリストを確認しま `TimedMetadataObjects`す。

   ここで、プレイヤーがブラックアウトの開始と終了を検出し、ブラックアウトの発生時間を追跡します。

1. ブラックアウト期間の開始と終了時にコンテンツを切り替えるメソッドを作成します。

   ブラックアウト期間が始まったら、メインコンテンツをバックグラウンドに切り替え、代替コンテンツをメインストリームに切り替えます。 引き続き、バックグラウンドで元のマニフェストの取得と解析を行い、「ブラックアウト終了」タグをチェックし続けます。これにより、ブラックアウトが終了したときにプレイヤーが元のストリームに再び参加できるようになります。

